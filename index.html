<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>Haytocen Snake VIP</title>
    <style>
        :root {
            --primary: #f1c40f;
            --bg: #0b0e11;
            --surface: #1c2128;
            --text: #ffffff;
            --text-dim: #8b949e;
            --canvas-bg: #111;
            --accent: #e74c3c;
            --success: #2ecc71;
            --btn-blue: #3498db;
        }

        body { 
            margin: 0; background: var(--bg); color: var(--text); 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif; 
            overflow: hidden; touch-action: none; -webkit-user-select: none; user-select: none;
            height: 100dvh;
        }

        #main-wrapper { max-width: 500px; margin: auto; height: 100%; display: flex; flex-direction: column; }

        .header { 
            background: var(--surface); padding: 0 15px; border-bottom: 2px solid var(--primary); 
            display: flex; justify-content: space-between; align-items: center; 
            height: 50px; flex-shrink: 0; z-index: 10;
        }
        .header-left { display: flex; gap: 15px; align-items: center; font-weight: 900; font-size: 18px; }

        .content-area { flex-grow: 1; position: relative; overflow-y: auto; overflow-x: hidden; display: flex; flex-direction: column; }
        .page-section { display: none; width: 100%; min-height: 100%; flex-direction: column; align-items: center; }

        /* GAME */
        #game-section { height: 100%; overflow: hidden; justify-content: space-between; padding-bottom: 10px; box-sizing: border-box; }
        .game-info { text-align: center; font-size: 12px; color: #aaa; padding: 5px; background: rgba(0,0,0,0.2); width: 100%; }
        .canvas-container { flex-grow: 1; width: 100%; display: flex; align-items: center; justify-content: center; position: relative; padding: 10px; box-sizing: border-box; }
        .canvas-wrapper { position: relative; box-shadow: 0 0 20px rgba(0,0,0,0.5); border-radius: 8px; }
        canvas { display: block; background: var(--canvas-bg); border: 2px solid var(--primary); border-radius: 8px; }
        .start-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); border-radius: 8px; display: flex; align-items: center; justify-content: center; z-index: 20; }
        .controls-area { flex-shrink: 0; display: flex; justify-content: center; margin-bottom: 5px; }
        .controls { display: grid; grid-template-columns: repeat(3, 60px); grid-template-rows: repeat(2, 50px); gap: 6px; }
        .ctrl-btn { width: 100%; height: 100%; background: var(--surface); border: 1px solid #444; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; color: var(--primary); box-shadow: 0 3px 0 #000; touch-action: manipulation; }
        .ctrl-btn:active { transform: translateY(3px); box-shadow: 0 0 0; background: #2a2f38; }

        /* WHEEL */
        .wheel-container { display: flex; flex-direction: column; align-items: center; gap: 15px; margin-top: 20px; }
        .wheel-outer { position: relative; width: 280px; height: 280px; border-radius: 50%; border: 8px solid var(--surface); overflow: hidden; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .wheel-pointer { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 30px; height: 40px; background: #e74c3c; clip-path: polygon(50% 100%, 0 0, 100% 0); z-index: 25; }
        #wheel { 
            width: 100%; height: 100%; border-radius: 50%; position: relative;
            transition: transform 5s cubic-bezier(0.1, 0, 0.1, 1); 
            background: conic-gradient(#f1c40f 0deg 45deg, #2c3e50 45deg 90deg, #f39c12 90deg 135deg, #34495e 135deg 180deg, #d4ac0d 180deg 225deg, #2c3e50 225deg 270deg, #e67e22 270deg 315deg, #8e44ad 315deg 360deg);
        }
        .wheel-label { position: absolute; top: 50%; left: 50%; width: 50%; height: 20px; margin-top: -10px; transform-origin: left center; display: flex; align-items: center; justify-content: flex-end; font-weight: 900; font-size: 12px; padding-right: 25px; box-sizing: border-box; color: #fff; text-shadow: 1px 1px 2px #000; }
        .l1 { transform: rotate(22.5deg); color: #000; text-shadow: none; } .l2 { transform: rotate(67.5deg); } .l3 { transform: rotate(112.5deg); color: #000; text-shadow: none; } .l4 { transform: rotate(157.5deg); } .l5 { transform: rotate(202.5deg); color: #000; text-shadow: none; } .l6 { transform: rotate(247.5deg); } .l7 { transform: rotate(292.5deg); color: #000; text-shadow: none; } .l8 { transform: rotate(337.5deg); }

        /* GENERAL */
        .scrollable-content { padding: 15px; width: 100%; box-sizing: border-box; }
        .card { background: var(--surface); padding: 15px; border-radius: 16px; width: 100%; margin-bottom: 12px; border: 1px solid #333; box-sizing: border-box; }
        .btn-main { padding: 10px 25px; border-radius: 10px; border: none; background: var(--primary); font-weight: 900; font-size: 14px; color: #000; cursor: pointer; }
        .btn-main:disabled { background: #444; color: #777; cursor: not-allowed; opacity: 0.5; }
        
        /* –ö–Ω–æ–ø–∫–∞ "–ö—É–ø–∏—Ç—å" */
        .btn-buy { padding: 8px 20px; border-radius: 10px; border: none; background: var(--btn-blue); font-weight: 900; font-size: 14px; color: #fff; cursor: pointer; box-shadow: 0 3px 0 #1e5a82; }
        .btn-buy:active { transform: translateY(2px); box-shadow: none; }

        /* –ö–Ω–æ–ø–∫–∞ "–í—ã–≤–µ—Å—Ç–∏" (–ó–µ–ª–µ–Ω–∞—è –∫–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞) */
        .btn-withdraw { width: 100%; padding: 12px; border-radius: 10px; border: none; background: var(--success); font-weight: 900; font-size: 16px; color: #000; cursor: pointer; margin-top: 10px; }
        .btn-withdraw:disabled { background: #444; color: #777; cursor: not-allowed; }

        .shop-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 10px; }

        .nav-bar { background: var(--surface); padding: 5px 0 20px; border-top: 1px solid #333; height: 65px; flex-shrink: 0; display: flex; z-index: 50; }
        .nav-item { flex: 1; text-align: center; color: var(--text-dim); cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .nav-item span { font-size: 20px; margin-bottom: 2px; }
        .nav-item div { font-size: 9px; font-weight: 800; text-transform: uppercase; }
        .nav-item.active { color: var(--primary); transform: scale(1.1); transition: transform 0.2s; }
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 100; text-align: center; }

        /* –°—Ç–∏–ª—å –¥–ª—è –±–ª–æ–∫–∞ –æ–±–º–µ–Ω–∞ */
        .exchange-row { display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; margin: 10px 0; font-weight: bold; font-size: 18px; }
    </style>
</head>
<body>
    <div id="main-wrapper">
        <div class="header">
            <div class="header-left">
                <span>üêç <span id="score">0</span></span>
                <span class="mute-btn" onclick="toggleMute()" id="muteIcon">üîá</span>
            </div>
            <div style="text-align: right;">
                <span style="font-size: 9px; opacity: 0.7;">–ë–ê–õ–ê–ù–°</span><br>
                <span style="color: var(--primary); font-weight: 900; font-size: 14px;"><span id="balance">0</span> HT</span>
            </div>
        </div>

        <div class="content-area">
            
            <div id="game-section" class="page-section" style="display: flex;">
                <div class="game-info">–°–æ–±–µ—Ä–∏ 40 –æ—á–∫–æ–≤ –¥–ª—è –±–æ–Ω—É—Å–∞!</div>
                <div class="canvas-container">
                    <div class="canvas-wrapper" id="canvasWrapper">
                        <canvas id="gameCanvas"></canvas>
                        <div id="startOverlay" class="start-overlay">
                            <button id="startBtn" class="btn-main" onclick="startGame()">–ò–ì–†–ê–¢–¨</button>
                        </div>
                    </div>
                </div>
                <div class="controls-area">
                    <div class="controls">
                        <div class="ctrl-btn" style="grid-column:2" onpointerdown="handleControl(event, 'UP')">‚ñ≤</div>
                        <div class="ctrl-btn" style="grid-column:1; grid-row:2" onpointerdown="handleControl(event, 'LEFT')">‚óÄ</div>
                        <div class="ctrl-btn" style="grid-column:3; grid-row:2" onpointerdown="handleControl(event, 'RIGHT')">‚ñ∂</div>
                        <div class="ctrl-btn" style="grid-column:2; grid-row:2" onpointerdown="handleControl(event, 'DOWN')">‚ñº</div>
                    </div>
                </div>
            </div>

            <div id="wheel-section" class="page-section scrollable-content">
                <div class="wheel-container">
                    <h2 style="color: var(--primary); margin: 0;">–ö–æ–ª–µ—Å–æ –£–¥–∞—á–∏</h2>
                    <div class="wheel-outer">
                        <div class="wheel-pointer"></div>
                        <div id="wheel">
                            <div class="wheel-label l1">1 HT</div>
                            <div class="wheel-label l2">0 HT</div>
                            <div class="wheel-label l3">–ï–©–Å!</div>
                            <div class="wheel-label l4">1 ‚≠ê</div>
                            <div class="wheel-label l5">5 HT</div>
                            <div class="wheel-label l6">10 HT</div>
                            <div class="wheel-label l7">25 HT</div>
                            <div class="wheel-label l8">VIP 1–î</div>
                        </div>
                    </div>
                    <button id="spinBtn" class="btn-main" style="width: 150px;" onclick="spinWheel()">–ö–†–£–¢–ò–¢–¨</button>
                    <p id="wheel-msg" style="color: var(--primary); font-weight: bold; min-height: 20px; text-align: center;"></p>
                </div>
            </div>

            <div id="shop-section" class="page-section scrollable-content">
                <h2 style="text-align: center; color: var(--primary); margin-top:0;">üíé VIP –ú–ê–ì–ê–ó–ò–ù</h2>
                <div class="card" style="border: 1px solid var(--primary); background: rgba(241, 196, 15, 0.05);">
                    <ul style="padding-left: 20px; margin:0; font-size: 13px; color: #ddd;">
                        <li><b>2x –ë–æ–Ω—É—Å—ã</b> –≤ –∏–≥—Ä–µ</li>
                        <li><b>2x –í—ã–∏–≥—Ä—ã—à</b> –≤ –ö–æ–ª–µ—Å–µ</li>
                        <li>üí∞ –õ–∏–º–∏—Ç –≤—ã–≤–æ–¥–∞ <b>2500 HT</b></li>
                    </ul>
                </div>
                <div class="card">
                    <div class="shop-item">
                        <div><b>5 –î–ù–ï–ô</b></div>
                        <button class="btn-buy" onclick="buyVip(5, 20)">20 ‚≠ê</button>
                    </div>
                    <div class="shop-item">
                        <div style="color: var(--primary);"><b>15 –î–ù–ï–ô</b></div>
                        <button class="btn-buy" onclick="buyVip(15, 150)">150 ‚≠ê</button>
                    </div>
                    <div class="shop-item">
                        <div style="color: #e74c3c;"><b>30 –î–ù–ï–ô</b></div>
                        <button class="btn-buy" onclick="buyVip(30, 500)">500 ‚≠ê</button>
                    </div>
                </div>
            </div>

            <div id="bonus-section" class="page-section scrollable-content">
                <div class="card" style="text-align: center; margin-top: 20px;">
                    <h2>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–∫—Å</h2>
                    <div style="font-size: 80px; margin: 20px;">üéÅ</div>
                    <button id="claimBtn" class="btn-main" style="width:100%;" onclick="claimDailyBonus()">–û–¢–ö–†–´–¢–¨</button>
                    <p id="bonus-msg" style="margin-top: 15px; font-size: 14px; color: #888;"></p>
                </div>
            </div>

            <div id="profile-section" class="page-section scrollable-content">
                <div class="card" style="text-align: center;">
                    <p style="margin:0; font-size: 14px;">–í–∞—à –±–∞–ª–∞–Ω—Å:</p>
                    <h1 style="color: var(--primary); font-size: 32px; margin: 5px 0;"><span id="profile-balance">0</span> HT</h1>
                    <p id="vip-status-profile" style="font-size: 14px; margin: 5px 0;"></p>
                </div>

                <div class="card" style="border: 2px solid var(--success);">
                    <h3 style="margin: 0; color: var(--success);">üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h3>
                    <p style="font-size: 12px; color: #aaa; margin-bottom: 5px;">–û–±–º–µ–Ω–Ω—ã–π –∫—É—Ä—Å:</p>
                    
                    <div class="exchange-row">
                        <span style="color: var(--primary);"><span id="withdraw-limit-text">5000</span> HT</span>
                        <span>‚û°Ô∏è</span>
                        <span style="color: var(--success);">1 $</span>
                    </div>

                    <p id="withdraw-status" style="font-size: 12px; text-align: center; margin: 5px 0;">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    <button id="withdrawBtn" class="btn-withdraw" onclick="withdrawMoney()" disabled>–û–ë–ú–ï–ù–Ø–¢–¨ –ò –í–´–í–ï–°–¢–ò</button>
                </div>

                <div class="card" style="border-left: 4px solid #2481cc;">
                    <h3>ü§ù –†–µ—Ñ–µ—Ä–∞–ª–∫–∞</h3>
                    <p style="font-size: 13px;">–ó–∞ –¥—Ä—É–≥–∞: <span style="color: var(--primary);">+15 HT</span></p>
                    <button class="btn-main" style="width:100%; background:#2481cc; color:#fff;" onclick="shareGame()">–ü–†–ò–ì–õ–ê–°–ò–¢–¨</button>
                </div>
            </div>

        </div>

        <div class="nav-bar">
            <div id="nav-game" class="nav-item active" onclick="showTab('game')"><span>üéÆ</span><div>–ò–ì–†–ê</div></div>
            <div id="nav-bonus" class="nav-item" onclick="showTab('bonus')"><span>üíé</span><div>–ë–û–ù–£–°</div></div>
            <div id="nav-wheel" class="nav-item" onclick="showTab('wheel')"><span>üé°</span><div>–£–î–ê–ß–ê</div></div>
            <div id="nav-shop" class="nav-item" onclick="showTab('shop')"><span>üõí</span><div>VIP</div></div>
            <div id="nav-profile" class="nav-item" onclick="showTab('profile')"><span>üë§</span><div>–Ø</div></div>
        </div>
    </div>

    <div id="modal" class="overlay">
        <h2 style="color: #e74c3c;">–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê</h2>
        <p id="end-score" style="font-size: 24px; color: #fff;"></p>
        <button class="btn-main" onclick="closeModal()">–ó–ê–ù–û–í–û</button>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let isMuted = true;
        
        function toggleMute() {
            isMuted = !isMuted;
            document.getElementById('muteIcon').innerText = isMuted ? 'üîá' : 'üîä';
            if(!isMuted && audioCtx.state === 'suspended') audioCtx.resume();
        }
        function playTone(f,d,t='square'){
            if(isMuted) return;
            const o=audioCtx.createOscillator(),g=audioCtx.createGain();
            o.type=t; o.frequency.value=f;
            g.gain.setValueAtTime(0.1,audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime+d/1000);
            o.connect(g); g.connect(audioCtx.destination);
            o.start(); o.stop(audioCtx.currentTime+d/1000);
        }

        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let box = 20; let rows, cols;
        let snake=[], food={}, d, isRunning=false;
        let points = parseInt(localStorage.getItem('ht_balance')) || 0;
        let vipExpiry = parseInt(localStorage.getItem('vipExpiry')) || 0;
        let isVip = false;

        function resizeGame() {
            const container = document.querySelector('.canvas-container');
            const maxWidth = container.clientWidth - 20; 
            const maxHeight = container.clientHeight - 20;
            const size = Math.min(maxWidth, maxHeight);
            const gridSize = 20; 
            box = Math.floor(size / gridSize); 
            const finalSize = box * gridSize;
            canvas.width = finalSize; canvas.height = finalSize;
            const wrapper = document.getElementById('canvasWrapper');
            wrapper.style.width = finalSize + 'px'; wrapper.style.height = finalSize + 'px';
            rows = canvas.height / box; cols = canvas.width / box;
            if(!isRunning && snake.length > 0) draw();
        }

        window.addEventListener('resize', resizeGame);

        function initGame() {
            resizeGame();
            snake = [{x: 5*box, y: 10*box}, {x: 4*box, y: 10*box}, {x: 3*box, y: 10*box}];
            food = spawnItem(); d = "RIGHT"; 
            checkVip(); updateUI(); draw();
        }

        function spawnItem() {
            return { x: Math.floor(Math.random() * cols) * box, y: Math.floor(Math.random() * rows) * box };
        }

        function startGame() {
            document.getElementById('startOverlay').style.display = 'none';
            isRunning = true;
            if(!isMuted && audioCtx.state === 'suspended') audioCtx.resume();
            initGame(); run();
        }

        function run() {
            if(!isRunning) return;
            let hx = snake[0].x, hy = snake[0].y;
            if(d=="LEFT") hx -= box; if(d=="UP") hy -= box;
            if(d=="RIGHT") hx += box; if(d=="DOWN") hy += box;

            if(hx < 0 || hx >= canvas.width || hy < 0 || hy >= canvas.height || snake.some(s => s.x === hx && s.y === hy)) {
                endGame(); return;
            }

            if(hx === food.x && hy === food.y) {
                points += isVip ? 2 : 1; 
                playTone(600, 100);
                food = spawnItem();
            } else { snake.pop(); }

            snake.unshift({x: hx, y: hy});
            draw(); updateUI(); setTimeout(run, 150);
        }

        function draw() {
            ctx.fillStyle = "#111"; ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.strokeStyle = "#222"; ctx.lineWidth = 1;
            for(let i=0; i<cols; i++) { ctx.beginPath(); ctx.moveTo(i*box,0); ctx.lineTo(i*box,canvas.height); ctx.stroke(); }
            for(let i=0; i<rows; i++) { ctx.beginPath(); ctx.moveTo(0,i*box); ctx.lineTo(canvas.width,i*box); ctx.stroke(); }
            for(let i=0; i<snake.length; i++) {
                if(i == 0) {
                    ctx.font = (box) + "px Arial";
                    ctx.textAlign = "center"; ctx.textBaseline = "middle";
                    ctx.fillText("üêç", snake[i].x + box/2, snake[i].y + box/2 + 2);
                } else {
                    ctx.fillStyle = "#2ecc71";
                    ctx.beginPath(); ctx.arc(snake[i].x + box/2, snake[i].y + box/2, box/2 - 2, 0, Math.PI*2); ctx.fill();
                }
            }
            ctx.font = (box) + "px Arial";
            ctx.textAlign = "center"; ctx.textBaseline = "middle";
            ctx.fillText("üçé", food.x + box/2, food.y + box/2 + 2);
        }

        function handleControl(e, dir) {
            e.preventDefault();
            if(dir=="UP" && d!="DOWN") d="UP";
            if(dir=="DOWN" && d!="UP") d="DOWN";
            if(dir=="LEFT" && d!="RIGHT") d="LEFT";
            if(dir=="RIGHT" && d!="LEFT") d="RIGHT";
        }

        function endGame() {
            isRunning = false;
            playTone(150, 500, 'sawtooth');
            document.getElementById('end-score').innerText = "–°—á–µ—Ç: " + (snake.length-3);
            document.getElementById('modal').style.display = 'flex';
        }
        function closeModal() { document.getElementById('modal').style.display = 'none'; document.getElementById('startOverlay').style.display = 'flex'; }

        // --- WHEEL LOGIC ---
        let currentRotation = 0;
        let isSpinning = false;
        const COOLDOWN_TIME = 4 * 60 * 60 * 1000; 

        function updateWheelTimer() {
            const lastSpin = parseInt(localStorage.getItem('lastSpinTime')) || 0;
            const now = Date.now();
            const diff = now - lastSpin;
            const btn = document.getElementById('spinBtn');
            const msg = document.getElementById('wheel-msg');

            if (diff < COOLDOWN_TIME) {
                const remaining = COOLDOWN_TIME - diff;
                const hours = Math.floor(remaining / (1000 * 60 * 60));
                const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
                btn.disabled = true;
                btn.innerText = `${hours}—á ${minutes}–º`;
                msg.innerText = "–û–∂–∏–¥–∞–π—Ç–µ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏...";
            } else {
                btn.disabled = false;
                btn.innerText = "–ö–†–£–¢–ò–¢–¨";
                msg.innerText = "–ö–æ–ª–µ—Å–æ –≥–æ—Ç–æ–≤–æ!";
            }
        }

        function spinWheel() {
            if(isSpinning) return;
            const lastSpin = parseInt(localStorage.getItem('lastSpinTime')) || 0;
            if(Date.now() - lastSpin < COOLDOWN_TIME) { return; }

            isSpinning = true;
            document.getElementById('spinBtn').disabled = true;
            
            const winVal = [1, 0, 0, 0, 5, 10, 25, 1][Math.floor(Math.random()*8)];
            const spins = 5 * 360; 
            const deg = Math.floor(Math.random() * 360);
            
            currentRotation += spins + deg;
            document.getElementById('wheel').style.transform = `rotate(${currentRotation}deg)`;

            setTimeout(() => {
                isSpinning = false;
                localStorage.setItem('lastSpinTime', Date.now());
                if(winVal > 0) {
                    points += isVip ? winVal * 2 : winVal;
                    document.getElementById('wheel-msg').innerText = `–í—ã–ø–∞–ª–æ: ${winVal} HT!`;
                } else {
                    document.getElementById('wheel-msg').innerText = "–ü—É—Å—Ç–æ –∏–ª–∏ –ó–≤–µ–∑–¥–∞!";
                }
                updateUI();
                updateWheelTimer();
            }, 5000);
        }

        // --- DAILY BONUS ---
        function checkDailyBonus() {
            const lastBonusDate = localStorage.getItem('lastBonusDate');
            const today = new Date().toDateString();
            const btn = document.getElementById('claimBtn');
            const msg = document.getElementById('bonus-msg');
            if (lastBonusDate === today) {
                btn.disabled = true; btn.style.opacity = "0.5"; btn.innerText = "–ó–ê–ë–†–ê–ù–û"; msg.innerText = "–ü—Ä–∏—Ö–æ–¥–∏ –∑–∞–≤—Ç—Ä–∞ –∑–∞ –Ω–∞–≥—Ä–∞–¥–æ–π!";
            } else {
                btn.disabled = false; btn.style.opacity = "1"; btn.innerText = "–û–¢–ö–†–´–¢–¨"; msg.innerText = "–ë–æ–Ω—É—Å –¥–æ—Å—Ç—É–ø–µ–Ω!";
            }
        }
        function claimDailyBonus() {
            const today = new Date().toDateString();
            if(localStorage.getItem('lastBonusDate') === today) return;
            points += isVip ? 50 : 25;
            localStorage.setItem('lastBonusDate', today);
            updateUI(); checkDailyBonus(); alert("–ë–æ–Ω—É—Å –ø–æ–ª—É—á–µ–Ω!");
        }

        // --- GENERAL & WITHDRAWAL ---
        function checkVip() {
            if(Date.now() < vipExpiry) {
                isVip = true;
                const days = Math.ceil((vipExpiry - Date.now()) / (86400000));
                document.getElementById('vip-status-profile').innerHTML = `<span style="color:#2ecc71">‚ú® VIP (${days} –¥–Ω.)</span>`;
            } else {
                isVip = false;
                document.getElementById('vip-status-profile').innerText = "–û–±—ã—á–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç";
            }
        }
        function buyVip(d, c) { 
            if(confirm(`–ö—É–ø–∏—Ç—å VIP –Ω–∞ ${d} –¥–Ω?`)) {
                vipExpiry = Date.now() + d*86400000; 
                localStorage.setItem('vipExpiry', vipExpiry); 
                checkVip(); updateUI(); // –û–±–Ω–æ–≤–∏—Ç –∏ –ª–∏–º–∏—Ç –≤—ã–≤–æ–¥–∞
            }
        }
        
        // –õ–û–ì–ò–ö–ê –í–´–í–û–î–ê –°–†–ï–î–°–¢–í
        function updateWithdrawUI() {
            const limit = isVip ? 2500 : 5000;
            const limitText = document.getElementById('withdraw-limit-text');
            const status = document.getElementById('withdraw-status');
            const btn = document.getElementById('withdrawBtn');

            limitText.innerText = limit;

            if(points >= limit) {
                btn.disabled = false;
                status.innerHTML = "<span style='color:#2ecc71'>–î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –≤—ã–≤–æ–¥–∞!</span>";
            } else {
                btn.disabled = true;
                const needed = limit - points;
                status.innerHTML = `<span style='color:#e74c3c'>–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç ${needed} HT</span>`;
            }
        }

        function withdrawMoney() {
            const limit = isVip ? 2500 : 5000;
            if(points >= limit) {
                if(confirm(`–û–±–º–µ–Ω—è—Ç—å ${limit} HT –Ω–∞ 1$?`)) {
                    points -= limit;
                    alert("‚úÖ –ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞! –í—ã —É—Å–ø–µ—à–Ω–æ –æ–±–º–µ–Ω—è–ª–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞. –î–µ–Ω—å–≥–∏ –ø–æ—Å—Ç—É–ø—è—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤.");
                    updateUI();
                }
            } else {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!");
            }
        }

        // === –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–†–ò–ì–õ–ê–®–ï–ù–ò–Ø ===
        function shareGame() {
            // –ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –°–í–û–ï –ò–ú–Ø –ë–û–¢–ê (–±–µ–∑ @)
            // –ù–∞–ø—Ä–∏–º–µ—Ä: const botLink = "https://t.me/SnakeGameBot";
            const botLink = "https://t.me/YOUR_BOT_USERNAME"; 
            
            const shareText = "–ò–≥—Ä–∞–π —Å–æ –º–Ω–æ–π –≤ Haytocen Snake VIP –∏ –ø–æ–ª—É—á–∞–π —Ç–æ–∫–µ–Ω—ã!";
            const shareUrl = `https://t.me/share/url?url=${encodeURIComponent(botLink)}&text=${encodeURIComponent(shareText)}`;

            // –ù–∞—á–∏—Å–ª—è–µ–º 15 HT —Å—Ä–∞–∑—É (–∏–º–∏—Ç–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª–∫–∏)
            points += 15;
            updateUI(); // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –Ω–∞ —ç–∫—Ä–∞–Ω–µ
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–∞—Ç–∏–≤–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –¥—Ä—É–∑–µ–π –≤ Telegram
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.openTelegramLink(shareUrl);
            } else {
                window.open(shareUrl, '_blank');
            }
        }

        function updateUI() {
            localStorage.setItem('ht_balance', points);
            document.getElementById('balance').innerText = points;
            document.getElementById('profile-balance').innerText = points;
            document.getElementById('score').innerText = snake.length > 3 ? snake.length-3 : 0;
            updateWithdrawUI(); // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤—ã–≤–æ–¥–∞
        }

        function showTab(t) {
            document.querySelectorAll('.page-section').forEach(e => e.style.display='none');
            const section = document.getElementById(t+'-section');
            section.style.display = (t === 'game') ? 'flex' : 'block';
            document.querySelectorAll('.nav-item').forEach(e => e.classList.remove('active'));
            document.getElementById('nav-'+t).classList.add('active');
            
            if(t === 'wheel') updateWheelTimer();
            if(t === 'bonus') checkDailyBonus();
            if(t === 'game') resizeGame();
            if(t === 'profile') updateWithdrawUI(); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –ø—Ä–æ—Ñ–∏–ª—å
        }

        setInterval(updateWheelTimer, 60000);

        window.onload = () => { 
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.expand(); // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
            }
            initGame(); 
            showTab('game'); 
        };
    </script>
</body>
</html>
