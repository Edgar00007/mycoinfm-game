<!DOCTYPE html>
<html lang="hy">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>MyCoinFM - ’ä’°’ø÷Ä’°’Ω’ø’´ ‘Ω’°’≤</title>
    <style>
        /* ’Ä’´’¥’∂’°’Ø’°’∂ ’Ø’°÷Ä’£’°’æ’∏÷Ä’∏÷Ç’¥’∂’•÷Ä */
        body { margin: 0; background: #0b0e11; color: white; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow: hidden; touch-action: manipulation; }
        #main-wrapper { max-width: 500px; margin: auto; height: 100vh; display: flex; flex-direction: column; }
        
        /* ’é’•÷Ä÷á’´ ’∞’°’ø’æ’°’Æ */
        .header { background: #1c2128; padding: 15px; border-bottom: 2px solid #f1c40f; display: flex; justify-content: space-between; align-items: center; z-index: 10; box-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        .balance-display { color: #f1c40f; font-weight: bold; font-size: 18px; }

        /* ‘≤’∏’¨’∏÷Ä ’¢’°’™’´’∂’∂’•÷Ä’´ ’®’∂’§’∞’°’∂’∏÷Ç÷Ä ’∏’≥’® */
        .page-section { 
            display: none; 
            padding: 20px; 
            flex-grow: 1; 
            background: #0b0e11; 
            overflow-y: auto; 
            box-sizing: border-box;
            width: 100%;
        }

        /* ‘Ω’°’≤’´ ’ß’Ø÷Ä’°’∂ */
        #game-section { display: block; position: relative; background: #87CEEB; padding: 0; overflow: hidden; }
        canvas { width: 100%; height: 100%; display: block; }

        /* ’î’°÷Ä’ø’•÷Ä’´ ’∏’≥’® (‘ø’°’¢’´’∂’•’ø ÷á ‘Ω’°’∂’∏÷Ç’©) */
        .card, .item-card { 
            background: #1c2128; 
            border-radius: 15px; 
            padding: 20px; 
            margin-bottom: 15px; 
            border: 1px solid #30363d; 
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .item-card { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            text-align: left; 
            border-left: 4px solid #f1c40f; 
        }

        /* ‘ø’∏’≥’°’Ø’∂’•÷Ä */
        .action-btn { 
            width: 100%; 
            padding: 14px; 
            border-radius: 10px; 
            border: none; 
            font-weight: bold; 
            font-size: 16px; 
            cursor: pointer; 
            transition: 0.2s;
            margin-top: 10px;
        }
        .btn-yellow { background: #f1c40f; color: black; }
        .btn-blue { background: #3498db; color: white; }
        .btn-red { background: #e74c3c; color: white; }
        .action-btn:disabled { background: #333 !important; color: #777 !important; }

        /* ‘±’∂’´’æ’´ ’∞’°’ø’æ’°’Æ */
        #wheel-container { position: relative; width: 260px; height: 260px; margin: 20px auto; }
        #wheelCanvas { border-radius: 50%; border: 5px solid #f1c40f; box-shadow: 0 0 15px rgba(241,196,15,0.4); }
        .wheel-pointer { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 30px solid #e74c3c; z-index: 5; }

        /* ‘≤’∏’∂’∏÷Ç’Ω’´ ÷Å’°’∂÷Å */
        .daily-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px; }
        .daily-day { background: #1c2128; border: 1px solid #30363d; border-radius: 10px; padding: 12px; font-size: 12px; position: relative; }
        .daily-day.active { border-color: #f1c40f; background: rgba(241, 196, 15, 0.15); }
        .daily-day.claimed::after { content: "‚úì"; position: absolute; top: 5px; right: 8px; color: #2ecc71; font-weight: bold; }

        /* ’Ü’°’æ’´’£’°÷Å’´’° */
        .nav-bar { display: flex; background: #161b22; border-top: 1px solid #30363d; padding-bottom: env(safe-area-inset-bottom); }
        .nav-item { flex: 1; padding: 15px 5px; text-align: center; cursor: pointer; color: #8b949e; font-weight: bold; font-size: 11px; transition: 0.3s; }
        .nav-item.active { color: #f1c40f; background: rgba(241, 196, 15, 0.1); border-top: 2px solid #f1c40f; }
    </style>
</head>
<body>

    <div id="main-wrapper">
        <div class="header">
            <span id="level-indicator" style="font-weight: bold; color: #8b949e;">’Ñ’°’Ø’°÷Ä’§’°’Ø: 1</span>
            <div class="balance-display"><span id="top-balance">0</span> HT</div>
        </div>

        <div id="game-section" class="page-section" style="display: block;">
            <canvas id="gameCanvas"></canvas>
            <button id="startBtn" class="action-btn btn-yellow" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); width: auto; padding: 15px 40px; border-radius: 30px;" onclick="initAndStart()">’ç‘ø’ç‘µ‘º</button>
        </div>

        <div id="daily-section" class="page-section">
            <h2 style="text-align: center; color: #f1c40f;">‘±’¥’•’∂÷Ö÷Ä’µ’° ‘≤’∏’∂’∏÷Ç’Ω</h2>
            <p style="text-align: center; color: #8b949e;">’Ñ’ø’´÷Ä ’≠’°’≤ ’°’¥’•’∂ ÷Ö÷Ä ÷á ’∞’°’æ’°÷Ñ’´÷Ä HT</p>
            <div class="daily-grid" id="dailyGrid"></div>
            <p id="dailyTimerText" style="text-align: center; color: #f1c40f; margin-top: 20px; font-weight: bold;"></p>
            <button id="claimDailyBtn" class="action-btn btn-yellow" onclick="claimDaily()">’é‘µ’ê’ë’Ü‘µ‘º</button>
        </div>

        <div id="wheel-section" class="page-section">
            <h2 style="text-align: center; color: #f1c40f;">‘≤’°’≠’ø’´ ‘±’∂’´’æ</h2>
            <div id="wheel-container">
                <div class="wheel-pointer"></div>
                <canvas id="wheelCanvas" width="250" height="250"></canvas>
            </div>
            <p id="wheel-timer" style="text-align: center; color: #8b949e;"></p>
            <button id="spinBtn" class="action-btn btn-yellow" onclick="spinWheel()">’ä’è’è‘µ‘º (4’™ ’Ñ‘µ‘ø)</button>
        </div>

        <div id="shop-section" class="page-section">
            <h2 style="text-align: center; color: #f1c40f;">‘Ω’°’∂’∏÷Ç’©</h2>
            <div class="item-card">
                <div><b>1000 HayToken</b><br><small style="color: #8b949e;">‘±÷Ä’™’•÷Ñ’®’ù 1000 ÷è</small></div>
                <button class="action-btn btn-yellow" style="width: auto; margin: 0; padding: 10px 20px;" onclick="buyAction('1000 HT')">‘≥’Ü‘µ‘º</button>
            </div>
            <div class="item-card">
                <div><b>VIP (X2 ’Ñ’´’°’æ’∏÷Ä)</b><br><small style="color: #8b949e;">‘±÷Ä’™’•÷Ñ’®’ù 2500 ÷è</small></div>
                <button class="action-btn btn-yellow" style="width: auto; margin: 0; padding: 10px 20px;" onclick="buyAction('VIP')">‘≥’Ü‘µ‘º</button>
            </div>
        </div>

        <div id="cabinet-section" class="page-section">
            <h2 style="text-align: center; color: #f1c40f;">‘±’∂’±’∂’°’Ø’°’∂ ‘∑’ª</h2>
            <div class="card">
                <div style="color:#8b949e; margin-bottom: 10px;">’Å‘µ’ê ’Ä‘±’á’é‘µ‘ø’á‘ª’å‘∏</div>
                <div id="ht-balance" style="font-size: 32px; color: #2ecc71; font-weight: bold; margin-bottom: 5px;">0.00 HT</div>
                <div style="color: #f1c40f; font-size: 18px;"><span id="amd-balance">0</span> ÷è (AMD)</div>
            </div>
            <div class="card" style="border-color: #3498db;">
                <h3 style="color: #3498db; margin: 0 0 10px 0;">’Ä÷Ä’°’æ’´÷Ä’´÷Ä ’®’∂’Ø’•÷Ä’∏’ª</h3>
                <p style="font-size: 13px; color: #8b949e;">’ç’ø’°÷Å’´÷Ä 20 HT ’°’¥’•’∂ ’¥’°÷Ä’§’∏÷Ç ’∞’°’¥’°÷Ä</p>
                <button class="action-btn btn-blue" onclick="shareRef()">‘ø‘ª’ç’é‘µ‘º ’Ä’Ç’à’í’Ñ’à’é</button>
            </div>
            <button id="withdrawBtn" class="action-btn btn-red" onclick="requestWithdraw()" disabled>’Ä‘±’Ü‘µ‘º ‘≥’à’í’Ñ‘±’ê‘∏</button>
        </div>

        <div class="nav-bar">
            <div class="nav-item active" id="nav-game" onclick="switchTab('game')">‘Ω‘±’Ç</div>
            <div class="nav-item" id="nav-daily" onclick="switchTab('daily')">‘≤’à’Ü’à’í’ç</div>
            <div class="nav-item" id="nav-wheel" onclick="switchTab('wheel')">‘±’Ü‘ª’é</div>
            <div class="nav-item" id="nav-shop" onclick="switchTab('shop')">‘Ω‘±’Ü’à’í‘π</div>
            <div class="nav-item" id="nav-cab" onclick="switchTab('cabinet')">‘∑’ã</div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        
        let totalPoints = parseFloat(localStorage.getItem('totalPoints')) || 0;
        let dailyDay = parseInt(localStorage.getItem('dailyDay')) || 1;
        const rewards = [5, 10, 15, 20, 25, 30, 50];

        // ‘∑’Ø÷Ä’°’∂’∂’•÷Ä’´ ÷É’∏÷É’∏’≠’∏÷Ç’©’µ’∏÷Ç’∂
        function switchTab(tab) {
            // ‘π’°÷Ñ÷Å’∂’•’¨ ’¢’∏’¨’∏÷Ä’®
            const sections = document.querySelectorAll('.page-section');
            sections.forEach(s => s.style.display = 'none');
            
            // ’ë’∏÷Ç÷Å’°’§÷Ä’•’¨ ’®’∂’ø÷Ä’æ’°’Æ’®
            const targetId = tab === 'game' ? 'game-section' : tab + '-section';
            const target = document.getElementById(targetId);
            if(target) target.style.display = 'block';

            // ‘±’Ø’ø’´’æ’°÷Å’∂’•’¨ ’Ø’∏’≥’°’Ø’® ’∂’°’æ’´’£’°÷Å’´’°’µ’´ ’¥’•’ª
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.getElementById('nav-' + tab).classList.add('active');

            // ‘π’°÷Ä’¥’°÷Å’∂’•’¨ ’ø’æ’µ’°’¨’∂’•÷Ä’® ’®’Ω’ø ’¢’°’™’∂’´
            if(tab === 'cabinet') updateStats();
            if(tab === 'daily') renderDaily();
            if(tab === 'wheel') drawWheel();
        }

        function updateStats() {
            let tokens = (totalPoints / 100).toFixed(2);
            document.getElementById('top-balance').innerText = Math.floor(tokens);
            document.getElementById('ht-balance').innerText = tokens + " HT";
            document.getElementById('amd-balance').innerText = Math.floor(tokens);
            document.getElementById('withdrawBtn').disabled = (tokens < 1000);
        }

        // --- ’ï’ê‘±‘ø‘±’Ü ‘≤’à’Ü’à’í’ç‘ª ’è’ê‘±’Ñ‘±‘≤‘±’Ü’à’í‘π’Ö’à’í’Ü ---
        function renderDaily() {
            const grid = document.getElementById('dailyGrid');
            grid.innerHTML = '';
            rewards.forEach((res, i) => {
                const dayNum = i + 1;
                const div = document.createElement('div');
                div.className = `daily-day ${dayNum === dailyDay ? 'active' : ''} ${dayNum < dailyDay ? 'claimed' : ''}`;
                div.innerHTML = `’ï÷Ä ${dayNum}<br><span style="font-size:22px">üíé</span><br><b>${res} HT</b>`;
                grid.appendChild(div);
            });
            updateDailyTimer();
        }

        function updateDailyTimer() {
            const lastClaim = localStorage.getItem('lastDailyClaim') || 0;
            const diff = 24*60*60*1000 - (Date.now() - lastClaim);
            const btn = document.getElementById('claimDailyBtn');
            const timerTxt = document.getElementById('dailyTimerText');

            if (diff > 0) {
                btn.disabled = true;
                const h = Math.floor(diff/3600000);
                const m = Math.floor((diff%3600000)/60000);
                timerTxt.innerText = `’Ä’°’ª’∏÷Ä’§’® ${h}’™ ${m}÷Ä-’´÷Å`;
            } else {
                btn.disabled = false;
                timerTxt.innerText = "’Ü’æ’•÷Ä’® ’∫’°’ø÷Ä’°’Ω’ø ’ß ’æ’•÷Ä÷Å’∂’•’¨’∏÷Ç";
            }
        }

        function claimDaily() {
            totalPoints += rewards[dailyDay - 1] * 100;
            localStorage.setItem('totalPoints', totalPoints);
            localStorage.setItem('lastDailyClaim', Date.now());
            dailyDay = dailyDay < 7 ? dailyDay + 1 : 1;
            localStorage.setItem('dailyDay', dailyDay);
            
            tg.showPopup({ title: "’á’∂’∏÷Ä’∞’°’æ’∏÷Ä!", message: "‘¥’∏÷Ç÷Ñ ’Ω’ø’°÷Å’°÷Ñ ’±’•÷Ä ÷Ö÷Ä’°’Ø’°’∂ ’∂’æ’•÷Ä’®" });
            renderDaily();
            updateStats();
        }

        // --- ‘±’Ü‘ª’é‘ª ’è’ê‘±’Ñ‘±‘≤‘±’Ü’à’í‘π’Ö’à’í’Ü ---
        const prizes = [
            { text: "10 HT", type: "ht", val: 10 },
            { text: "1 Star", type: "star", val: 1 },
            { text: "0 HT", type: "miss", val: 0 },
            { text: "20 HT", type: "ht", val: 20 },
            { text: "1 Star", type: "star", val: 1 },
            { text: "5 HT", type: "ht", val: 5 }
        ];

        function drawWheel() {
            const canvas = document.getElementById('wheelCanvas');
            const ctx = canvas.getContext('2d');
            const arc = (Math.PI * 2) / prizes.length;
            prizes.forEach((p, i) => {
                ctx.fillStyle = i % 2 === 0 ? "#1c2128" : "#f1c40f";
                ctx.beginPath();
                ctx.moveTo(125, 125);
                ctx.arc(125, 125, 125, i * arc, (i + 1) * arc);
                ctx.fill();
                ctx.save();
                ctx.translate(125, 125);
                ctx.rotate(i * arc + arc / 2);
                ctx.fillStyle = i % 2 === 0 ? "white" : "black";
                ctx.font = "bold 13px Arial";
                ctx.fillText(p.text, 65, 5);
                ctx.restore();
            });
        }

        function spinWheel() {
            const last = localStorage.getItem('lastSpin') || 0;
            if (Date.now() - last < 4*60*60*1000) return;

            const deg = Math.floor(Math.random() * 360) + 3600;
            document.getElementById('wheelCanvas').style.transform = `rotate(${deg}deg)`;
            localStorage.setItem('lastSpin', Date.now());

            setTimeout(() => {
                const idx = Math.floor(((360 - (deg % 360) + 90) % 360) / (360 / prizes.length));
                const p = prizes[idx];
                if(p.type === 'ht') totalPoints += p.val * 100;
                tg.showPopup({ title: "‘±’∂’´’æ", message: `‘¥’∏÷Ç÷Ñ ’∑’°’∞’•÷Å’´÷Ñ ${p.text}` });
                updateStats();
            }, 4000);
        }

        // --- ‘±’Ö‘º ’ñ’à’í’Ü‘ø’ë‘ª‘±’Ü‘µ’ê ---
        function shareRef() {
            const url = `https://t.me/MyCoinFMBot?start=${tg.initDataUnsafe?.user?.id || 0}`;
            tg.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(url)}&text=’Ñ’´’°÷Å’´÷Ä ’´’∂’± MyCoinFM-’∏÷Ç’¥!`);
        }

        function buyAction(item) {
            tg.showPopup({ title: "‘≥’∂’∏÷Ç’¥", message: item + " ’£’∂’•’¨’∏÷Ç ’∞’°’¥’°÷Ä ’£÷Ä’•÷Ñ ’°’§’¥’´’∂’´’∂" }, () => {
                tg.openTelegramLink("https://t.me/Edgar_Admin");
            });
        }

        function requestWithdraw() {
            const wallet = prompt("’Ñ’∏÷Ç’ø÷Ñ’°’£÷Ä’•÷Ñ ’Å’•÷Ä ÷Ñ’°÷Ä’ø’´ ’∞’°’¥’°÷Ä’® ’Ø’°’¥ Idram-’®:");
            if(wallet) tg.showPopup({ message: "’Ä’°’µ’ø’® ’∞’°’ª’∏’≤’∏÷Ç’©’µ’°’¥’¢ ’∏÷Ç’≤’°÷Ä’Ø’æ’•÷Å ’°’§’¥’´’∂’´’∂:" });
        }

        function initAndStart() {
            document.getElementById('startBtn').style.display = 'none';
            // ‘±’µ’Ω’ø’•’≤ ’∫’•’ø÷Ñ ’ß ’¨’´’∂’´ ’≠’°’≤’´ ’®’∂’©’°÷Å÷Ñ’´ ’Ø’∏’§’®
        }

        // ’ç’Ø’¶’¢’∂’°’Ø’°’∂ ’©’°÷Ä’¥’°÷Å’∏÷Ç’¥
        updateStats();
        setInterval(updateDailyTimer, 60000); // ‘π’°÷Ä’¥’°÷Å’∂’•’¨ ’™’°’¥’°’π’°÷É’® ’°’¥’•’∂ ÷Ä’∏’∫’•
    </script>
</body>
</html>
