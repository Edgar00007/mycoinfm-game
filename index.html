<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>Haytocen Snake VIP</title>
    <style>
        :root {
            --primary: #f1c40f;
            --bg: #0b0e11;
            --surface: #1c2128;
            --text: #ffffff;
            --text-dim: #8b949e;
            --canvas-bg: #111;
            --accent: #e74c3c;
            --success: #2ecc71;
            --btn-blue: #3498db;
        }

        body { 
            margin: 0; background: var(--bg); color: var(--text); 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif; 
            overflow: hidden; touch-action: none; -webkit-user-select: none; user-select: none;
            height: 100dvh;
        }

        #main-wrapper { max-width: 500px; margin: auto; height: 100%; display: flex; flex-direction: column; }

        .header { 
            background: var(--surface); padding: 0 15px; border-bottom: 2px solid var(--primary); 
            display: flex; justify-content: space-between; align-items: center; 
            height: 50px; flex-shrink: 0; z-index: 10;
        }
        .header-left { display: flex; gap: 15px; align-items: center; font-weight: 900; font-size: 18px; }

        .content-area { flex-grow: 1; position: relative; overflow-y: auto; overflow-x: hidden; display: flex; flex-direction: column; }
        .page-section { display: none; width: 100%; min-height: 100%; flex-direction: column; align-items: center; }

        #game-section { height: 100%; overflow: hidden; justify-content: space-between; padding-bottom: 10px; box-sizing: border-box; }
        .game-info { text-align: center; font-size: 12px; color: #aaa; padding: 5px; background: rgba(0,0,0,0.2); width: 100%; }
        .canvas-container { flex-grow: 1; width: 100%; display: flex; align-items: center; justify-content: center; position: relative; padding: 10px; box-sizing: border-box; }
        .canvas-wrapper { position: relative; box-shadow: 0 0 20px rgba(0,0,0,0.5); border-radius: 8px; }
        canvas { display: block; background: var(--canvas-bg); border: 2px solid var(--primary); border-radius: 8px; }
        .start-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); border-radius: 8px; display: flex; align-items: center; justify-content: center; z-index: 20; }
        .controls-area { flex-shrink: 0; display: flex; justify-content: center; margin-bottom: 5px; }
        .controls { display: grid; grid-template-columns: repeat(3, 60px); grid-template-rows: repeat(2, 50px); gap: 6px; }
        .ctrl-btn { width: 100%; height: 100%; background: var(--surface); border: 1px solid #444; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; color: var(--primary); box-shadow: 0 3px 0 #000; touch-action: manipulation; }
        .ctrl-btn:active { transform: translateY(3px); box-shadow: 0 0 0; background: #2a2f38; }

        .wheel-container { display: flex; flex-direction: column; align-items: center; gap: 15px; margin-top: 20px; }
        .wheel-outer { position: relative; width: 280px; height: 280px; border-radius: 50%; border: 8px solid var(--surface); overflow: hidden; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .wheel-pointer { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 30px; height: 40px; background: #e74c3c; clip-path: polygon(50% 100%, 0 0, 100% 0); z-index: 25; }
        #wheel { 
            width: 100%; height: 100%; border-radius: 50%; position: relative;
            transition: transform 5s cubic-bezier(0.1, 0, 0.1, 1); 
            background: conic-gradient(#f1c40f 0deg 45deg, #2c3e50 45deg 90deg, #f39c12 90deg 135deg, #34495e 135deg 180deg, #d4ac0d 180deg 225deg, #2c3e50 225deg 270deg, #e67e22 270deg 315deg, #8e44ad 315deg 360deg);
        }
        .wheel-label { position: absolute; top: 50%; left: 50%; width: 50%; height: 20px; margin-top: -10px; transform-origin: left center; display: flex; align-items: center; justify-content: flex-end; font-weight: 900; font-size: 12px; padding-right: 25px; box-sizing: border-box; color: #fff; text-shadow: 1px 1px 2px #000; }
        .l1 { transform: rotate(22.5deg); color: #000; text-shadow: none; } .l2 { transform: rotate(67.5deg); } .l3 { transform: rotate(112.5deg); color: #000; text-shadow: none; } .l4 { transform: rotate(157.5deg); } .l5 { transform: rotate(202.5deg); color: #000; text-shadow: none; } .l6 { transform: rotate(247.5deg); } .l7 { transform: rotate(292.5deg); color: #000; text-shadow: none; } .l8 { transform: rotate(337.5deg); }

        .scrollable-content { padding: 15px; width: 100%; box-sizing: border-box; }
        .card { background: var(--surface); padding: 15px; border-radius: 16px; width: 100%; margin-bottom: 12px; border: 1px solid #333; box-sizing: border-box; }
        .btn-main { padding: 10px 25px; border-radius: 10px; border: none; background: var(--primary); font-weight: 900; font-size: 14px; color: #000; cursor: pointer; }
        .btn-buy { padding: 8px 20px; border-radius: 10px; border: none; background: var(--btn-blue); font-weight: 900; font-size: 14px; color: #fff; cursor: pointer; box-shadow: 0 3px 0 #1e5a82; }
        .btn-withdraw { width: 100%; padding: 12px; border-radius: 10px; border: none; background: var(--success); font-weight: 900; font-size: 16px; color: #000; cursor: pointer; margin-top: 10px; }
        .btn-withdraw:disabled { background: #444; color: #777; cursor: not-allowed; }
        .shop-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .nav-bar { background: var(--surface); padding: 5px 0 20px; border-top: 1px solid #333; height: 65px; flex-shrink: 0; display: flex; z-index: 50; }
        .nav-item { flex: 1; text-align: center; color: var(--text-dim); cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .nav-item span { font-size: 20px; margin-bottom: 2px; }
        .nav-item div { font-size: 9px; font-weight: 800; text-transform: uppercase; }
        .nav-item.active { color: var(--primary); transform: scale(1.1); transition: transform 0.2s; }
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 100; text-align: center; }
        .exchange-row { display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; margin: 10px 0; font-weight: bold; font-size: 18px; }
    </style>
</head>
<body>
    <div id="main-wrapper">
        <div class="header">
            <div class="header-left">
                <span>üêç <span id="score">0</span></span>
                <span class="mute-btn" onclick="toggleMute()" id="muteIcon">üîá</span>
            </div>
            <div style="text-align: right;">
                <span style="font-size: 9px; opacity: 0.7;">‘≤‘±‘º‘±’Ü’ç</span><br>
                <span style="color: var(--primary); font-weight: 900; font-size: 14px;"><span id="balance">0</span> HT</span>
            </div>
        </div>

        <div class="content-area">
            <div id="game-section" class="page-section" style="display: flex;">
                <div class="game-info">’Ä’°’æ’°÷Ñ’´÷Ä 40 ’¥’´’°’æ’∏÷Ä ’¢’∏’∂’∏÷Ç’Ω’´ ’∞’°’¥’°÷Ä!</div>
                <div class="canvas-container">
                    <div class="canvas-wrapper" id="canvasWrapper">
                        <canvas id="gameCanvas"></canvas>
                        <div id="startOverlay" class="start-overlay">
                            <button id="startBtn" class="btn-main" onclick="startGame()">‘Ω‘±’Ç‘±‘º</button>
                        </div>
                    </div>
                </div>
                <div class="controls-area">
                    <div class="controls">
                        <div class="ctrl-btn" style="grid-column:2" onpointerdown="handleControl(event, 'UP')">‚ñ≤</div>
                        <div class="ctrl-btn" style="grid-column:1; grid-row:2" onpointerdown="handleControl(event, 'LEFT')">‚óÄ</div>
                        <div class="ctrl-btn" style="grid-column:3; grid-row:2" onpointerdown="handleControl(event, 'RIGHT')">‚ñ∂</div>
                        <div class="ctrl-btn" style="grid-column:2; grid-row:2" onpointerdown="handleControl(event, 'DOWN')">‚ñº</div>
                    </div>
                </div>
            </div>

            <div id="wheel-section" class="page-section scrollable-content">
                <div class="wheel-container">
                    <h2 style="color: var(--primary); margin: 0;">‘±’∂’´’æ</h2>
                    <div class="wheel-outer">
                        <div class="wheel-pointer"></div>
                        <div id="wheel">
                            <div class="wheel-label l1">1 HT</div>
                            <div class="wheel-label l2">0 HT</div>
                            <div class="wheel-label l3">‘ø’ê‘ø‘ª’Ü</div>
                            <div class="wheel-label l4">1 ‚≠ê</div>
                            <div class="wheel-label l5">5 HT</div>
                            <div class="wheel-label l6">10 HT</div>
                            <div class="wheel-label l7">25 HT</div>
                            <div class="wheel-label l8">VIP 1’ï÷Ä</div>
                        </div>
                    </div>
                    <button id="spinBtn" class="btn-main" style="width: 150px;" onclick="spinWheel()">’ä’è’è‘µ‘º</button>
                    <p id="wheel-msg" style="color: var(--primary); font-weight: bold; min-height: 20px; text-align: center;"></p>
                </div>
            </div>

            <div id="shop-section" class="page-section scrollable-content">
                <h2 style="text-align: center; color: var(--primary); margin-top:0;">üíé VIP ‘Ω‘±’Ü’à’í‘π</h2>
                <div class="card" style="border: 1px solid var(--primary); background: rgba(241, 196, 15, 0.05);">
                    <ul style="padding-left: 20px; margin:0; font-size: 13px; color: #ddd;">
                        <li><b>2x ‘≤’∏’∂’∏÷Ç’Ω</b> ’≠’°’≤’∏÷Ç’¥</li>
                        <li><b>2x ’Ä’°’≤’©’°’∂’°’Ø</b> ‘±’∂’´’æ’∏÷Ç’¥</li>
                        <li>üí∞ ’Ä’°’∂’¥’°’∂ ’¨’´’¥’´’ø <b>2500 HT</b></li>
                    </ul>
                </div>
                <div class="card">
                    <div class="shop-item"><div><b>5 ’ï’ê</b></div><button class="btn-buy" onclick="buyVip(5, 20)">20 ‚≠ê</button></div>
                    <div class="shop-item"><div style="color: var(--primary);"><b>15 ’ï’ê</b></div><button class="btn-buy" onclick="buyVip(15, 150)">150 ‚≠ê</button></div>
                    <div class="shop-item"><div style="color: #e74c3c;"><b>30 ’ï’ê</b></div><button class="btn-buy" onclick="buyVip(30, 500)">500 ‚≠ê</button></div>
                </div>
            </div>

            <div id="bonus-section" class="page-section scrollable-content">
                <div class="card" style="text-align: center; margin-top: 20px;">
                    <h2>’ï÷Ä’°’Ø’°’∂ ’¢’∏’∂’∏÷Ç’Ω</h2>
                    <div style="font-size: 80px; margin: 20px;">üéÅ</div>
                    <button id="claimBtn" class="btn-main" style="width:100%;" onclick="claimDailyBonus()">‘≤‘±’ë‘µ‘º</button>
                    <p id="bonus-msg" style="margin-top: 15px; font-size: 14px; color: #888;"></p>
                </div>
            </div>

            <div id="profile-section" class="page-section scrollable-content">
                <div class="card" style="text-align: center;">
                    <p style="margin:0; font-size: 14px;">’Å’•÷Ä ’∞’°’∑’´’æ’®:</p>
                    <h1 style="color: var(--primary); font-size: 32px; margin: 5px 0;"><span id="profile-balance">0</span> HT</h1>
                    <p id="vip-status-profile" style="font-size: 14px; margin: 5px 0;"></p>
                </div>
                <div class="card" style="border: 2px solid var(--success);">
                    <h3 style="margin: 0; color: var(--success);">üí∏ ’ì’∏’≠’°’∂’°’Ø’∏÷Ç’¥</h3>
                    <div class="exchange-row">
                        <span style="color: var(--primary);"><span id="withdraw-limit-text">5000</span> HT</span>
                        <span>‚û°Ô∏è</span>
                        <span style="color: var(--success);">1 $</span>
                    </div>
                    <p id="withdraw-status" style="font-size: 12px; text-align: center; margin: 5px 0;">‘≤’•’º’∂’∏÷Ç’¥...</p>
                    <button id="withdrawBtn" class="btn-withdraw" onclick="withdrawMoney()" disabled>’ì’à‘Ω‘±’Ü‘±‘ø‘µ‘º</button>
                </div>
                <div class="card" style="border-left: 4px solid #2481cc;">
                    <h3>ü§ù ’å’•÷Ü’•÷Ä’°’¨</h3>
                    <p style="font-size: 13px;">‘∏’∂’Ø’•÷Ä’∏’ª ’∞’°’¥’°÷Ä: <span style="color: var(--primary);">+15 HT</span></p>
                    <button class="btn-main" style="width:100%; background:#2481cc; color:#fff;" onclick="shareGame()">’Ä’ê‘±’é‘ª’ê‘µ‘º</button>
                </div>
            </div>
        </div>

        <div class="nav-bar">
            <div id="nav-game" class="nav-item active" onclick="showTab('game')"><span>üéÆ</span><div>‘Ω‘±’Ç</div></div>
            <div id="nav-bonus" class="nav-item" onclick="showTab('bonus')"><span>üíé</span><div>‘≤’à’Ü’à’í’ç</div></div>
            <div id="nav-wheel" class="nav-item" onclick="showTab('wheel')"><span>üé°</span><div>‘±’Ü‘ª’é</div></div>
            <div id="nav-shop" class="nav-item" onclick="showTab('shop')"><span>üõí</span><div>VIP</div></div>
            <div id="nav-profile" class="nav-item" onclick="showTab('profile')"><span>üë§</span><div>‘µ’ç</div></div>
        </div>
    </div>

    <div id="modal" class="overlay">
        <h2 style="color: #e74c3c;">‘Ω‘±’Ç’Ü ‘±’é‘±’ê’è’é‘µ’ë</h2>
        <p id="end-score" style="font-size: 24px; color: #fff;"></p>
        <button class="btn-main" onclick="closeModal()">‘ø’ê‘ø‘ª’Ü</button>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        let isMuted = true;
        function toggleMute() {
            isMuted = !isMuted;
            document.getElementById('muteIcon').innerText = isMuted ? 'üîá' : 'üîä';
            if(!isMuted && audioCtx.state === 'suspended') audioCtx.resume();
        }
        function playTone(f,d,t='square'){
            if(isMuted) return;
            const o=audioCtx.createOscillator(),g=audioCtx.createGain();
            o.type=t; o.frequency.value=f;
            g.gain.setValueAtTime(0.1,audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime+d/1000);
            o.connect(g); g.connect(audioCtx.destination);
            o.start(); o.stop(audioCtx.currentTime+d/1000);
        }

        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let box = 20, rows, cols, snake=[], food={}, d, isRunning=false;
        let points = parseInt(localStorage.getItem('ht_balance')) || 0;
        let vipExpiry = parseInt(localStorage.getItem('vipExpiry')) || 0;
        let isVip = false;

        function resizeGame() {
            const container = document.querySelector('.canvas-container');
            const size = Math.min(container.clientWidth - 20, container.clientHeight - 20);
            box = Math.floor(size / 20); 
            canvas.width = box * 20; canvas.height = box * 20;
            const wrapper = document.getElementById('canvasWrapper');
            wrapper.style.width = canvas.width + 'px'; wrapper.style.height = canvas.height + 'px';
            rows = 20; cols = 20;
        }

        function initGame() {
            resizeGame();
            snake = [{x: 5*box, y: 10*box}, {x: 4*box, y: 10*box}, {x: 3*box, y: 10*box}];
            food = spawnItem(); d = "RIGHT"; checkVip(); updateUI(); draw();
        }
        function spawnItem() { return { x: Math.floor(Math.random() * cols) * box, y: Math.floor(Math.random() * rows) * box }; }
        function startGame() { document.getElementById('startOverlay').style.display = 'none'; isRunning = true; initGame(); run(); }

        function run() {
            if(!isRunning) return;
            let hx = snake[0].x, hy = snake[0].y;
            if(d=="LEFT") hx -= box; if(d=="UP") hy -= box;
            if(d=="RIGHT") hx += box; if(d=="DOWN") hy += box;
            if(hx < 0 || hx >= canvas.width || hy < 0 || hy >= canvas.height || snake.some(s => s.x === hx && s.y === hy)) { endGame(); return; }
            if(hx === food.x && hy === food.y) { points += isVip ? 2 : 1; playTone(600, 100); food = spawnItem(); } else { snake.pop(); }
            snake.unshift({x: hx, y: hy}); draw(); updateUI(); setTimeout(run, 150);
        }

        function draw() {
            ctx.fillStyle = "#111"; ctx.fillRect(0,0,canvas.width,canvas.height);
            for(let i=0; i<snake.length; i++) {
                if(i == 0) { ctx.font = (box) + "px Arial"; ctx.fillText("üêç", snake[i].x, snake[i].y + box); }
                else { ctx.fillStyle = "#2ecc71"; ctx.fillRect(snake[i].x+1, snake[i].y+1, box-2, box-2); }
            }
            ctx.fillText("üçé", food.x, food.y + box);
        }

        function handleControl(e, dir) { 
            e.preventDefault(); 
            if(dir=="UP" && d!="DOWN") d="UP"; if(dir=="DOWN" && d!="UP") d="DOWN";
            if(dir=="LEFT" && d!="RIGHT") d="LEFT"; if(dir=="RIGHT" && d!="LEFT") d="RIGHT";
        }
        function endGame() { isRunning = false; document.getElementById('modal').style.display = 'flex'; }
        function closeModal() { document.getElementById('modal').style.display = 'none'; document.getElementById('startOverlay').style.display = 'flex'; }

        function spinWheel() {
            const lastSpin = parseInt(localStorage.getItem('lastSpinTime')) || 0;
            if(Date.now() - lastSpin < 14400000) return;
            const deg = 1800 + Math.random() * 360;
            document.getElementById('wheel').style.transform = `rotate(${deg}deg)`;
            setTimeout(() => {
                const win = [1, 5, 10][Math.floor(Math.random()*3)];
                points += isVip ? win*2 : win;
                localStorage.setItem('lastSpinTime', Date.now());
                updateUI();
            }, 5000);
        }

        function claimDailyBonus() {
            const today = new Date().toDateString();
            if(localStorage.getItem('lastBonusDate') === today) return;
            points += isVip ? 50 : 25;
            localStorage.setItem('lastBonusDate', today);
            updateUI(); checkDailyBonus();
        }

        function checkDailyBonus() {
            const btn = document.getElementById('claimBtn');
            btn.disabled = localStorage.getItem('lastBonusDate') === new Date().toDateString();
        }

        function checkVip() {
            isVip = Date.now() < vipExpiry;
            document.getElementById('vip-status-profile').innerText = isVip ? "‚ú® VIP Active" : "Regular Account";
        }

        function buyVip(d, c) { 
            vipExpiry = Date.now() + d*86400000; 
            localStorage.setItem('vipExpiry', vipExpiry); 
            checkVip(); updateUI(); 
        }

        // === –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–†–ò–ì–õ–ê–®–ï–ù–ò–Ø ===
        function shareGame() {
            const botLink = "https://t.me/MyCoinFMBot"; 
            const shareText = "’Ñ’´’°÷Å’´÷Ä ’´’∂’± MyCoinFM-’∏÷Ç’¥! üêç ‘Ω’°’≤’° ÷á ’∞’°’æ’°÷Ñ’´÷Ä HT ’ø’∏’Ø’•’∂’∂’•÷Ä:";
            const shareUrl = `https://t.me/share/url?url=${encodeURIComponent(botLink)}&text=${encodeURIComponent(shareText)}`;
            points += 15;
            updateUI();
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.openTelegramLink(shareUrl);
            } else {
                window.open(shareUrl, '_blank');
            }
        }

        function updateUI() {
            localStorage.setItem('ht_balance', points);
            document.getElementById('balance').innerText = points;
            document.getElementById('profile-balance').innerText = points;
            const limit = isVip ? 2500 : 5000;
            document.getElementById('withdraw-limit-text').innerText = limit;
            document.getElementById('withdrawBtn').disabled = points < limit;
            document.getElementById('withdraw-status').innerText = points < limit ? `’ä’•’ø÷Ñ ’ß ÷á’Ω ${limit - points} HT` : "’Ä’°’Ω’°’∂’•’¨’´ ’ß!";
        }

        function showTab(t) {
            document.querySelectorAll('.page-section').forEach(e => e.style.display='none');
            document.getElementById(t+'-section').style.display = (t === 'game') ? 'flex' : 'block';
            document.querySelectorAll('.nav-item').forEach(e => e.classList.remove('active'));
            document.getElementById('nav-'+t).classList.add('active');
        }

        window.onload = () => { if(window.Telegram && window.Telegram.WebApp) window.Telegram.WebApp.expand(); initGame(); showTab('game'); };
    </script>
</body>
</html>
